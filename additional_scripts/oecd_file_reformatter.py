import pandas as pd

# Data (copy-paste your values)
data = [
    ("2020-11-01 00:00:00", "97,88219"),
    ("2020-12-01 00:00:00", "98,06979"),
    ("2021-01-01 00:00:00", "98,53454"),
    ("2021-02-01 00:00:00", "98,87374"),
    ("2021-03-01 00:00:00", "98,78824"),
    ("2021-04-01 00:00:00", "98,11855"),
    ("2021-05-01 00:00:00", "97,61825"),
    ("2021-06-01 00:00:00", "97,59113"),
    ("2021-07-01 00:00:00", "97,48471"),
    ("2021-08-01 00:00:00", "97,29325"),
    ("2021-09-01 00:00:00", "96,97616"),
    ("2021-10-01 00:00:00", "96,24303"),
    ("2021-11-01 00:00:00", "95,33971"),
    ("2021-12-01 00:00:00", "94,87467"),
    ("2022-01-01 00:00:00", "94,93996"),
    ("2022-02-01 00:00:00", "94,8883"),
    ("2022-03-01 00:00:00", "94,61234"),
    ("2022-04-01 00:00:00", "93,97101"),
    ("2022-05-01 00:00:00", "93,47193"),
    ("2022-06-01 00:00:00", "93,28676"),
    ("2022-07-01 00:00:00", "93,84404"),
    ("2022-08-01 00:00:00", "94,7011"),
    ("2022-09-01 00:00:00", "95,42516"),
    ("2022-10-01 00:00:00", "96,04954"),
    ("2022-11-01 00:00:00", "96,41219"),
    ("2022-12-01 00:00:00", "96,71954"),
    ("2023-01-01 00:00:00", "97,30893"),
    ("2023-02-01 00:00:00", "98,02856"),
    ("2023-03-01 00:00:00", "98,7425"),
    ("2023-04-01 00:00:00", "99,67429"),
    ("2023-05-01 00:00:00", "99,94245"),
    ("2023-06-01 00:00:00", "98,9427"),
    ("2023-07-01 00:00:00", "97,20549"),
    ("2023-08-01 00:00:00", "95,5195")
]


# Create DataFrame
df = pd.DataFrame(data, columns=["date_str", "confidence_raw"])

# Parse date
df["date"] = pd.to_datetime(df["date_str"])

# Extract year and month
df["year"] = df["date"].dt.year
df["month"] = df["date"].dt.month

# Convert confidence
df["oecd_confidence"] = df["confidence_raw"].str.replace(",", ".").astype(float)

# Select final columns
final_df = df[["year", "month", "oecd_confidence"]]

# Save to CSV
final_df.to_csv("../datasets/oecd_cons_conf_index.csv", index=False)

print("CSV file saved successfully.")
